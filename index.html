<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Ø¯Ø§ÛŒÛŒ Ø¬ÙˆØ§Ø¯</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: Tahoma, Arial, sans-serif;
      height: 100vh;
      overflow: hidden;
      touch-action: none;
      user-select: none;
      color: #222;
    }

    .screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    #entry-screen {
      background: 
        linear-gradient(rgba(255, 248, 230, 0.9), rgba(255, 248, 230, 0.9)),
        url('https://i.postimg.cc/x8hC14Kd/file-00000000755c7208bb3debc5534b6779.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .main-title {
      position: absolute;
      top: 30px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 30px;
      font-weight: bold;
      color: #8B0000;
      text-shadow: 0 2px 4px rgba(255,215,0,0.5);
    }

    .right-col, .left-col {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 25px;
    }
    .right-col { right: 30px; }
    .left-col { left: 30px; }

    .menu-item {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: transform 0.2s;
      box-shadow: 0 3px 8px rgba(0,0,0,0.25);
      position: relative;
    }
    .menu-item:active { transform: scale(0.93); }

    .icon { font-size: 24px; line-height: 1; }
    .menu-label {
      position: absolute;
      bottom: -28px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 12px;
      font-weight: bold;
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.6);
      white-space: nowrap;
    }

    #item-suggestions { background: #4ECDC4; }
    #item-about { background: #06D6A0; }
    #item-invite { background: #FFD166; color: #222; }
    #item-guide { background: #118AB2; }
    #item-special1 { background: #EF476F; }
    #item-special2 { background: #FF6B6B; }

    #start-main {
      position: absolute;
      bottom: 110px;
      left: 50%;
      transform: translateX(-50%);
      padding: 14px 30px;
      font-size: 20px;
      font-weight: bold;
      background: #FFD700;
      color: #222;
      border: 3px solid #B8860B;
      border-radius: 14px;
      cursor: pointer;
      box-shadow: 0 5px 12px rgba(0,0,0,0.25);
    }

    .footer {
      position: absolute;
      bottom: 20px;
      width: 100%;
      text-align: center;
      font-size: 15px;
      font-weight: bold;
      color: #222;
    }
    .footer-line {
      display: inline-block;
      width: 70%;
      max-width: 280px;
      border-top: 2px solid #B8860B;
      margin-bottom: 6px;
    }

    #login-screen {
      background: linear-gradient(135deg, #b8860b, #ffd700);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    #login-screen h2 {
      margin-bottom: 20px;
      color: #8B0000;
      font-size: 24px;
    }
    input {
      padding: 14px;
      font-size: 20px;
      border-radius: 12px;
      border: 2px solid #ffd700;
      text-align: center;
      width: 85%;
      max-width: 300px;
      margin: 12px 0;
      background: rgba(255,255,255,0.85);
    }
    .action-btn {
      margin: 15px 0;
      padding: 12px 28px;
      font-size: 20px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: bold;
      background: #ffd700;
      color: #222;
      box-shadow: 0 4px 8px rgba(0,0,0,0.25);
      border: 2px solid #b8860b;
    }

    .back-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      background: #6c757d;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 6px 12px;
      font-size: 14px;
      cursor: pointer;
    }

    #game-screen {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    #ui-bar {
      position: absolute;
      top: 16px;
      left: 16px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    #dai-help {
      padding: 8px 14px;
      background: #FFD700;
      border: 3px solid #B8860B;
      border-radius: 10px;
      color: #222;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(0,0,0,0.25);
      min-width: 90px;
      text-align: center;
    }

    #coins { 
      display: flex; 
      align-items: center; 
      gap: 6px; 
      background: rgba(255,255,255,0.7); 
      padding: 6px 12px; 
      border-radius: 20px; 
      font-size: 16px; 
    }

    #logout-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      background: #ff6b6b;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 6px 12px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
    }

    #letters-container {
      position: relative;
      width: 260px;
      height: 260px;
      margin: 20px 0;
    }

    .letter {
      position: absolute;
      width: 55px;
      height: 55px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 22px;
      font-weight: bold;
      transition: 0.25s;
    }

    #lines { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }

    #word-boxes {
      display: flex;
      gap: 10px;
      margin: 15px 0;
      flex-wrap: wrap;
      justify-content: center;
    }
    .char-box {
      width: 28px;
      height: 28px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 18px;
    }

    #selected-word {
      font-size: 26px;
      margin: 15px 0;
      letter-spacing: 4px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    #stage-title {
      font-size: 24px;
      font-weight: bold;
      margin: 15px 0;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    #hint-panel {
      position: absolute;
      top: 70px;
      left: 16px;
      background: white;
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
      display: none;
      flex-direction: column;
      gap: 10px;
      min-width: 190px;
    }
    #hint-panel button {
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
    }
    #hint-letter { background: #FFD700; color: #222; border: 1px solid #B8860B; }
    #hint-skip { background: #ff6b6b; color: white; }

    #thank-you {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 100;
      font-size: 28px;
      color: white;
      font-weight: bold;
      text-align: center;
      padding: 20px;
    }
  </style>
</head>
<body>

<!-- ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ -->
<div id="entry-screen" class="screen">
  <div class="main-title">Ø¨Ø§Ø²ÛŒ Ø¯Ø§ÛŒÛŒ Ø¬ÙˆØ§Ø¯</div>

  <div class="right-col">
    <div class="menu-item" id="item-suggestions">
      <div class="icon">ğŸ’¡</div>
      <div class="menu-label">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª</div>
    </div>
    <div class="menu-item" id="item-about">
      <div class="icon">â„¹ï¸</div>
      <div class="menu-label">Ø¯Ø±Ø¨Ø§Ø±Ù‡</div>
    </div>
    <div class="menu-item" id="item-invite">
      <div class="icon">ğŸ‘«</div>
      <div class="menu-label">Ø¯Ø¹ÙˆØª</div>
    </div>
  </div>

  <div class="left-col">
    <div class="menu-item" id="item-guide">
      <div class="icon">ğŸ“–</div>
      <div class="menu-label">Ø±Ø§Ù‡Ù†Ù…Ø§</div>
    </div>
    <div class="menu-item" id="item-special1">
      <div class="icon">ğŸ</div>
      <div class="menu-label">ÙˆÛŒÚ˜Ù‡</div>
    </div>
    <div class="menu-item" id="item-special2">
      <div class="icon">â­</div>
      <div class="menu-label">Ø³ØªØ§Ø±Ù‡</div>
    </div>
  </div>

  <button id="start-main">ğŸ® Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>

  <div class="footer">
    <div class="footer-line"></div>
    ØªÙ‚Ø¯ÛŒÙ… Ø¨Ù‡ Ø³Ø§Ø­Øª Ø­Ø¶Ø±Øª ÙØ§Ø·Ù…Ù‡ (Ø³)
  </div>

  <!-- Ù†Ø§Ù… Ú©Ø§Ù†Ø§Ù„ Ø³Ø§Ø²Ù†Ø¯Ù‡ -->
  <div style="
    position: absolute;
    bottom: 60px;
    left: 20px;
    font-size: 14px;
    font-weight: bold;
    color: #8B0000;
    text-shadow: 0 1px 2px rgba(255,215,0,0.5);
    background: rgba(255, 248, 230, 0.8);
    padding: 4px 10px;
    border-radius: 8px;
    font-family: Tahoma, Arial, sans-serif;
  ">
    Ú©Ø§Ù†Ø§Ù„: @Modafe_islam
  </div>
</div>

<!-- ØµÙØ­Ù‡ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… -->
<div id="login-screen" class="screen" style="display:none;">
  <button class="back-btn" id="back-to-entry">â† Ø¨Ø§Ø²Ú¯Ø´Øª</button>
  <h2>Ø§Ø³Ù…Øª Ú†ÛŒÙ‡ Ø¹Ø²ÛŒØ²Ù…ØŸ</h2>
  <input id="player" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" maxlength="15">
  <button class="action-btn" id="start-game">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
</div>

<!-- ØµÙØ­Ù‡ Ø¨Ø§Ø²ÛŒ -->
<div id="game-screen" class="screen" style="display:none;">
  <div id="ui-bar">
    <button id="dai-help">Ø¯Ø§ÛŒÛŒ Ú©Ù…Ú©</button>
    <div id="coins">ğŸª™ <span id="coin-count">Û°</span></div>
  </div>
  <button id="logout-btn">Ø®Ø±ÙˆØ¬</button>

  <div id="word-boxes"></div>
  <div id="letters-container"></div>
  <svg id="lines"></svg>
  <div id="selected-word">...</div>
  <div id="stage-title">Ù…Ø±Ø­Ù„Ù‡ Û±</div>
  <button class="action-btn" id="check-btn">Ø¨Ø±Ø±Ø³ÛŒ</button>

  <div id="hint-panel">
    <button id="hint-letter">ğŸ’¡ ÛŒÚ© Ø­Ø±Ù (Ûµ Ø³Ú©Ù‡)</button>
    <button id="hint-skip">ğŸšª Ø±Ø¯ Ù…Ø±Ø­Ù„Ù‡ (Û±Ûµ Ø³Ú©Ù‡)</button>
  </div>
</div>

<!-- Ù¾Ù†Ù„ ØªØ´Ú©Ø± -->
<div id="thank-you"></div>

<script>
// ========== 150 Ù…Ø±Ø­Ù„Ù‡ ==========
const stages = [
  {letters:["Ø®","Ø§","Ù†","Ù‡","Ùˆ"], words:["Ø®Ø§Ù†Ù‡"]},
  {letters:["Ø³","Ù„","Ø§","Ù…","Ø±"], words:["Ø³Ù„Ø§Ù…"]},
  {letters:["Ø¨","Ø§","Ø±","Ø§","Ù†","Ùˆ"], words:["Ø¨Ø§Ø±Ø§Ù†"]},
  {letters:["Ø´","Ø§","Ø¯","Ø¨","Ùˆ"], words:["Ø´Ø§Ø¯"]},
  {letters:["Ù","Ø±","Ø§","Ù‡","Ù†","Ø³"], words:["Ø±Ø§Ù‡"]},
  {letters:["Ú¯","Ù„","Ø³","Øª","Ø§","Ù…"], words:["Ú¯Ù„"]},
  {letters:["Ù…","Ø±","ÛŒ","Ù…","Ø§","Ù†"], words:["Ù…Ø±ÛŒÙ…"]},
  {letters:["Ù†","Ùˆ","Ø±","Ø§","Ù†","Ø´"], words:["Ù†ÙˆØ±"]},
  {letters:["Ø¯","Ø±","Ø³","Øª","Ø§","Ùˆ"], words:["Ø¯Ø±Ø³"]},
  {letters:["Ø¨","Ø§","Ø¯","Ø§","Ø±","Ùˆ"], words:["Ø¨Ø§Ø¯"]},
  {letters:["Ø³","ÛŒ","Ù†","Ø§","Ù…","Ø±"], words:["Ø³ÛŒÙ†Ø§"]},
  {letters:["Ú©","Ø§","Ù„","Ø§","Ù…","Ø±"], words:["Ú©Ù„Ø§Ù…"]},
  {letters:["Øª","Ø§","Ø¨","Ø³","Øª","Ø±"], words:["ØªØ§Ø¨"]},
  {letters:["Ù‡","Ùˆ","Ø§","Ø´","Ø§","ÛŒ"], words:["Ù‡ÙˆØ§"]},
  {letters:["Ø±","Ùˆ","Ø¨","Ø§","Øª","Ù†"], words:["Ø±Ø¨Ø§Øª"]},
  {letters:["Ù…","Ù‡","Ø±","Ø§","Ù†","Ùˆ"], words:["Ù…Ù‡Ø±Ø§Ù†"]},
  {letters:["Ù†","Ø§","Ù…","Ø¯","Ø±","Ùˆ"], words:["Ù†Ø§Ù…"]},
  {letters:["Ø³","Ø§","Ø±","Ø§","Ù‡","Ù…"], words:["Ø³Ø§Ø±Ø§"]},
  {letters:["Ø´","Ù‡","Ø±","Ø§","Ù†","Ùˆ"], words:["Ø´Ù‡Ø±"]},
  {letters:["Ù","Ø§","Ø±","ÛŒ","Ø¯","Ùˆ"], words:["ÙØ±ÛŒØ¯"]},
  {letters:["Ú©","ÛŒ","Ù…","ÛŒ","Ø§","Ù†"], words:["Ú©ÛŒÙ…ÛŒØ§"]},
  {letters:["Ù†","ÛŒ","Ù„","Ùˆ","Ù","Ø±"], words:["Ù†ÛŒÙ„ÙˆÙØ±"]},
  {letters:["Ù…","Ø§","Ù‡","ÛŒ","Ù†","Ùˆ"], words:["Ù…Ø§Ù‡ÛŒ"]},
  {letters:["Ø³","Ø§","Ù…","ÛŒ","Ø±","Ù†"], words:["Ø³Ø§Ù…"]},
  {letters:["Ù‡","Ùˆ","Ø´","Ø§","Ù†","Ø±"], words:["Ù‡ÙˆØ´"]},
  {letters:["Ø¯","Ø§","Ùˆ","Ùˆ","Ø¯","Ù†"], words:["Ø¯Ø§ÙˆØ¯"]},
  {letters:["Ø´","Ø§","Ù‡","Ø±","Ùˆ","Ù†"], words:["Ø´Ù‡Ø±"]},
  {letters:["Ù…","Ù†","Ø§","Ø±","Ú©","Ùˆ"], words:["Ù…Ù†Ø§Ø±"]},
  {letters:["Ø±","Ùˆ","Ø²","Ø§","Ù†","Ùˆ"], words:["Ø±ÙˆØ²"]},
  {letters:["Ù","Ø§","Ø±","Ø³","Ø§","ÛŒ"], words:["ÙØ§Ø±Ø³Ø§"]},
  {letters:["Ú©","Ø§","Ø±","Ù…","ÛŒ","Ù†"], words:["Ú©Ø§Ø±"]},
  {letters:["Ø³","Ø§","Ù„","ÛŒ","Ù…","Ø±"], words:["Ø³Ø§Ù„"]},
  {letters:["Ù†","Ø§","Ø²","Ù„","ÛŒ","Ùˆ"], words:["Ù†Ø§Ø²"]},
  {letters:["Ø¯","Ø§","Ø±","ÛŒ","Ø§","Ù†"], words:["Ø¯Ø§Ø±Ø§"]},
  {letters:["Ø´","Ø§","Ø¯","Ø±","Ø§","Ùˆ"], words:["Ø´Ø§Ø¯"]},
  {letters:["Ù…","Ù‡","Ø§","Ø±","Ø§","Ù†"], words:["Ù…Ø§Ù‡Ø§"]},
  {letters:["Ù†","ÛŒ","Ú©","Ø§","Ù…","Ø±"], words:["Ù†ÛŒÚ©"]},
  {letters:["Ù","Ø±","Ø²","Ø§","Ù†","Ùˆ"], words:["ÙØ±Ø²Ø§Ù†"]},
  {letters:["Ú¯","Ø§","Ø±","Ø¯","Ø§","Ùˆ"], words:["Ú¯Ø§Ø±Ø¯"]},
  {letters:["Ø³","Ø§","Ù…","Ø§","Ù†","Ø±"], words:["Ø³Ø§Ù…Ø§Ù†"]},
  {letters:["Ù‡","Ø±","Ø§","Ù…","ÛŒ","Ù†"], words:["Ù‡Ø±Ù…Ø²"]},
  {letters:["Ù…","Ø§","Ù‡","Ø±","Ø§","Ù†"], words:["Ù…Ø§Ù‡Ø±"]},
  {letters:["Ù†","Ø§","Ø¨","Ø§","Ø±","Ùˆ"], words:["Ù†Ø§Ø¨"]},
  {letters:["Ø¯","Ùˆ","Ø³","Øª","Ø§","Ù†"], words:["Ø¯ÙˆØ³Øª"]},
  {letters:["Ø´","Ø§","Ù…","Ø§","Ù†","Ø±"], words:["Ø´Ø§Ù…"]},
  {letters:["Ú©","Ø§","Ù…","Ø±","Ø§","Ù†"], words:["Ú©Ø§Ù…Ø±Ø§Ù†"]},
  {letters:["Ù","Ø§","Ø±","Ù‡","Ø§","Ù†"], words:["ÙØ±Ù‡Ø§"]},
  {letters:["Ù…","ÛŒ","Ø±","Ø§","Ø¯","Ù†"], words:["Ù…ÛŒØ±Ø§"]},
  {letters:["Ù†","Ùˆ","Ø´","Ø§","Ù†","Ø±"], words:["Ù†ÙˆØ´Ø§"]},
  {letters:["Ø³","Ø§","Ù‡","Ø§","Ø±","Ù†"], words:["Ø³Ø§Ù‡"]},
  {letters:["Ø¯","Ø§","Ù†","Ø§","Ø´","Ùˆ"], words:["Ø¯Ø§Ù†Ø´"]},
  {letters:["Ø±","Ùˆ","Ø´","Ø§","Ù†","Ùˆ"], words:["Ø±ÙˆØ´Ø§"]},
  {letters:["Ø¨","Ù†","Ø¯","Ø±","Ùˆ","Ø§"], words:["Ø¨Ù†Ø¯Ø±"]},
  {letters:["Ù¾","Ø§","Ø±","Ø³","Ø§"], words:["Ù¾Ø§Ø±Ø³"]},
  {letters:["Ø´","ÛŒ","Ø±","Ø§","Ø²","Ùˆ"], words:["Ø´ÛŒØ±Ø§Ø²"]},
  {letters:["Ø§","Øµ","Ù","Ù‡","Ø§","Ù†"], words:["Ø§ØµÙÙ‡Ø§Ù†"]},
  {letters:["Øª","Ø¨","Ø±","ÛŒ","Ø²","Ùˆ"], words:["ØªØ¨Ø±ÛŒØ²"]},
  {letters:["Ù…","Ø´","Ù‡","Ø¯","Ùˆ","Ø§"], words:["Ù…Ø´Ù‡Ø¯"]},
  {letters:["ÛŒ","Ø²","Ø¯","Ùˆ","Ø§"], words:["ÛŒØ²Ø¯"]},
  {letters:["Ú©","Ø±","Ù…","Ø§","Ù†","Ùˆ"], words:["Ú©Ø±Ù…Ø§Ù†"]},
  {letters:["Ø§","Ù‡","Ùˆ","Ø§","Ø²","Ùˆ"], words:["Ø§Ù‡ÙˆØ§Ø²"]},
  {letters:["Ø±","Ø´","Øª","Ùˆ","Ø§"], words:["Ø±Ø´Øª"]},
  {letters:["Ù‚","Ø´","Ù…","Ùˆ","Ø§"], words:["Ù‚Ø´Ù…"]},
  {letters:["Ù†","ÛŒ","Ø´","Ø§","Ø¨","Ùˆ","Ø±"], words:["Ù†ÛŒØ´Ø§Ø¨ÙˆØ±"]},
  {letters:["Ø³","Ø¨","Ø²","Ùˆ","Ø§","Ù†"], words:["Ø³Ø¨Ø²Ø§Ù†"]},
  {letters:["Ø³","Ù¾","Ù†","Ø¯","Ùˆ","Ø§"], words:["Ø³Ù¾Ù†Ø¯"]},
  {letters:["Ø§","Ø±","Øº","Ùˆ","Ø§","Ù†"], words:["Ø§Ø±ØºÙˆØ§Ù†"]},
  {letters:["Ù…","Ù‡","Ø±","Ø¢","Ø¨","Ø§","Ø¯"], words:["Ù…Ù‡Ø±Ø¢Ø¨Ø§Ø¯"]},
  {letters:["Ú©","Ù†","Ø¬","Ùˆ","Ø§"], words:["Ú©Ù†Ø¬"]},
  {letters:["Ø­","Ø§","Ø¬","ÛŒ","Ø¬","Ø§","Ù†"], words:["Ø­Ø§Ø¬ÛŒØ¬Ø§Ù†"]},
  {letters:["Ù†","Ùˆ","Ø±","Ùˆ","Ø²","Ùˆ","Ø§"], words:["Ù†ÙˆØ±ÙˆØ²"]},
  {letters:["Ø¹","ÛŒ","Ø¯","Ùˆ","Ø§"], words:["Ø¹ÛŒØ¯"]},
  {letters:["Ù‚","Ø±","Ø¨","Ø§","Ù†","Ùˆ","Ø§"], words:["Ù‚Ø±Ø¨Ø§Ù†"]},
  {letters:["Ù…","Ù‡","Ø±","Ú¯","Ø§","Ù†","Ùˆ","Ø§"], words:["Ù…Ù‡Ø±Ú¯Ø§Ù†"]},
  {letters:["Ø³","Ù…","Ù†","Ùˆ","Ùˆ","Ø§"], words:["Ø³Ù…Ù†Ùˆ"]},
  {letters:["ÛŒ","Ø§","Ø³","Ùˆ","Ø§"], words:["ÛŒØ§Ø³"]},
  {letters:["Ù„","Ø§","Ù„","Ù‡","Ùˆ","Ø§"], words:["Ù„Ø§Ù„Ù‡"]},
  {letters:["Ù†","Ø±","Ú¯","Ø³","Ùˆ","Ø§"], words:["Ù†Ø±Ú¯Ø³"]},
  {letters:["Ø³","Ø¨","Ø²","Ù‡","Ùˆ","Ø§"], words:["Ø³Ø¨Ø²Ù‡"]},
  {letters:["Ø´","ÛŒ","Ø±","Ùˆ","Ø§"], words:["Ø´ÛŒØ±"]},
  {letters:["Ø¯","Ø®","Øª","Ø±","Ùˆ","Ø§"], words:["Ø¯Ø®ØªØ±"]},
  {letters:["Ù¾","Ø³","Ø±","Ùˆ","Ø§"], words:["Ù¾Ø³Ø±"]},
  {letters:["Ù†","Ùˆ","Ù‡","Ùˆ","Ø§"], words:["Ù†ÙˆÙ‡"]},
  {letters:["Ø¹","Ù…","Ù‡","Ùˆ","Ø§"], words:["Ø¹Ù…Ù‡"]},
  {letters:["Ø®","Ø§","Ù„","Ù‡","Ùˆ","Ø§"], words:["Ø®Ø§Ù„Ù‡"]},
  {letters:["Ø¹","Ù…","Ùˆ","Ùˆ","Ø§"], words:["Ø¹Ù…Ùˆ"]},
  {letters:["Ø¯","Ø§","ÛŒ","ÛŒ","Ùˆ","Ø§"], words:["Ø¯Ø§ÛŒÛŒ"]},
  {letters:["Ù¾","Ø¯","Ø±","Ùˆ","Ø§"], words:["Ù¾Ø¯Ø±"]},
  {letters:["Ù…","Ø§","Ø¯","Ø±","Ùˆ","Ø§"], words:["Ù…Ø§Ø¯Ø±"]},
  {letters:["Ø¨","Ø±","Ø§","Ø¯","Ø±","Ùˆ","Ø§"], words:["Ø¨Ø±Ø§Ø¯Ø±"]},
  {letters:["Ø®","Ùˆ","Ø§","Ù‡","Ø±","Ùˆ","Ø§"], words:["Ø®ÙˆØ§Ù‡Ø±"]},
  {letters:["Ù‡","Ù†","Ø±","Ùˆ","Ø§"], words:["Ù‡Ù†Ø±"]},
  {letters:["Ø¯","Ø§","Ù†","Ø´","Ùˆ","Ø§"], words:["Ø¯Ø§Ù†Ø´"]},
  {letters:["Ø¹","Ù‚","Ù„","Ùˆ","Ø§"], words:["Ø¹Ù‚Ù„"]},
  {letters:["Ù","Ú©","Ø±","Ùˆ","Ø§"], words:["ÙÚ©Ø±"]},
  {letters:["Ù…","Ù†","Ø¸","Ùˆ","Ø±","Ø§"], words:["Ù…Ù†Ø¸ÙˆØ±"]},
  {letters:["Ù‚","Ù„","Ù…","Ùˆ","Ø§"], words:["Ù‚Ù„Ù…"]},
  {letters:["Ú©","Øª","Ø§","Ø¨","Ùˆ","Ø§"], words:["Ú©ØªØ§Ø¨"]},
  {letters:["Ù…","Ø¯","Ø±","Ø³","Ù‡","Ùˆ","Ø§"], words:["Ù…Ø¯Ø±Ø³Ù‡"]},
  {letters:["Ù¾","Ø§","ÛŒ","ÛŒ","Ø²","Ùˆ"], words:["Ù¾Ø§ÛŒÛŒØ²"]},
  {letters:["Ø¨","Ù‡","Ø§","Ø±","Ùˆ","Ø§"], words:["Ø¨Ù‡Ø§Ø±"]},
  {letters:["Ø²","Ù…","Ø³","Øª","Ø§","Ù†","Ùˆ"], words:["Ø²Ù…Ø³ØªØ§Ù†"]},
  {letters:["Øª","Ø§","Ø¨","Ø³","Øª","Ø§","Ù†","Ùˆ"], words:["ØªØ§Ø¨Ø³ØªØ§Ù†"]},
  {letters:["Ø¨","Ø±","Ù","Ùˆ","Ø§"], words:["Ø¨Ø±Ù"]},
  {letters:["Ø¨","Ø§","Ø±","Ø§","Ù†","Ùˆ","Ø§"], words:["Ø¨Ø§Ø±Ø§Ù†"]},
  {letters:["Ø±","Ùˆ","Ø¯","Ùˆ","Ø§"], words:["Ø±ÙˆØ¯"]},
  {letters:["Ø¬","Ù†","Ú¯","Ù„","Ùˆ","Ø§"], words:["Ø¬Ù†Ú¯Ù„"]},
  {letters:["Ø¨","Ø§","Øº","Ùˆ","Ø§"], words:["Ø¨Ø§Øº"]},
  {letters:["Ú©","Ùˆ","Ù‡","Ùˆ","Ø§"], words:["Ú©ÙˆÙ‡"]},
  {letters:["Ø¯","Ø±","ÛŒ","Ø§","Ùˆ","Ø§"], words:["Ø¯Ø±ÛŒØ§"]},
  {letters:["Ø²","Ù…","ÛŒ","Ù†","Ùˆ","Ø§"], words:["Ø²Ù…ÛŒÙ†"]},
  {letters:["Ø¢","Ø³","Ù…","Ø§","Ù†","Ùˆ","Ø§"], words:["Ø¢Ø³Ù…Ø§Ù†"]},
  {letters:["Ù…","Ù†","Ø¯","Ù†","Ùˆ","Ø§"], words:["Ù…ÙÙ†Ø¯Ù†"]},
  {letters:["Øª","Ø§","Ø±","ÛŒ","Ú©","Ùˆ","Ø§"], words:["ØªØ§Ø±ÛŒÚ©"]},
  {letters:["Ù†","Ùˆ","Ø±","Ùˆ","Ø§"], words:["Ù†ÙˆØ±"]},
  {letters:["Ø´","Ø§","Ø¯","Ù…","Ù†","Ø¯","Ùˆ"], words:["Ø´Ø§Ø¯Ù…Ø§Ù†"]},
  {letters:["Øº","Ù…","Ùˆ","Ø§"], words:["ØºÙ…"]},
  {letters:["Ù","Ø±","Ø­","Ùˆ","Ø§"], words:["ÙØ±Ø­"]},
  {letters:["Ù†","Ùˆ","Ø´","Ùˆ","Ø§"], words:["Ù†ÙˆØ´"]},
  {letters:["Ø®","Ùˆ","Ø´","Ùˆ","Ø§"], words:["Ø®ÙˆØ´"]},
  {letters:["Ù†","Ø³","Øª","Ø¹","Ù„","ÛŒ","Ù‚"], words:["Ù†Ø³ØªØ¹Ù„ÛŒÙ‚"]},
  {letters:["Ù†","Ú¯","Ø§","Ø±","Ùˆ","Ø§"], words:["Ù†Ú¯Ø§Ø±"]},
  {letters:["Ù†","Ù‚","Ø´","Ùˆ","Ø§"], words:["Ù†Ù‚Ø´"]},
  {letters:["Ø·","Ù„","Ø¹","ÛŒ","Ùˆ","Ø§"], words:["Ø·Ù„Ø§ÛŒÛŒ"]},
  {letters:["Ù‚","Ø±","Ù…","Ø²","Ùˆ","Ø§"], words:["Ù‚Ø±Ù…Ø²"]},
  {letters:["Ø³","Ø¨","Ø²","Ùˆ","Ø§"], words:["Ø³Ø¨Ø²"]},
  {letters:["Ø¨","Ù†","Ù","Ø´","Ùˆ","Ø§"], words:["Ø¨Ù†ÙØ´"]},
  {letters:["Ù†","Ø§","Ø²","Ùˆ","Ø¨"], words:["Ù†Ø§Ø²"]},
  {letters:["Ø²","ÛŒ","Ø¨","Ø§","Ùˆ","Ù†"], words:["Ø²ÛŒØ¨Ø§"]},
  {letters:["Ù†","Ø±","Ù…","Ø¨","Ø§"], words:["Ù†Ø±Ù…"]},
  {letters:["Ù…","Ø­","Ø¨","Øª","Ùˆ","Ø§"], words:["Ù…Ø­Ø¨Øª"]},
  {letters:["Ù‚","Ø¯","Ø±","Ø¯","Ø§","Ù†","Ùˆ"], words:["Ù‚Ø¯Ø±Ø¯Ø§Ù†"]},
  {letters:["Ø³","Ù¾","Ø§","Ø³","Ø´","Ø¨"], words:["Ø³Ù¾Ø§Ø³"]},
  {letters:["Ù…","Ù‡","Ø±","Ø¨","Ø§","Ù†","Ùˆ"], words:["Ù…Ù‡Ø±Ø§Ø¨Ø§Ù†"]},
  {letters:["Ø®","Ùˆ","Ø´","Ø¨","Ø®","Øª","Ù¾"], words:["Ø®ÙˆØ´Ø¨Ø®Øª"]},
  {letters:["Ø¯","Ùˆ","Ø³","Øª","Ø´","Ø§"], words:["Ø¯ÙˆØ³Øª"]},
  {letters:["Ø±","Ù","Ù‚","Øº","Ø§"], words:["Ø±ÙÙ‚Ø§"]},
  {letters:["Ù¾","Ø±","Ùˆ","Ø§","ÛŒ"], words:["Ù¾Ø±ÙˆØ§"]},
  {letters:["Ø¢","Ø±","Ù…","Ø§","Ù†","Ø¨"], words:["Ø¢Ø±Ù…Ø§Ù†"]},
  {letters:["Ø´","Ø§","Ø¯","ÛŒ","Ùˆ","Ù‡"], words:["Ø´Ø§Ø¯ÛŒ"]},
  {letters:["Ø§","Ù…","ÛŒ","Ø¯","Ù‡","Ùˆ"], words:["Ø§Ù…ÛŒØ¯"]},
  {letters:["Ø¹","Ø´","Ù‚","Øµ","Ø§"], words:["Ø¹Ø´Ù‚"]},
  {letters:["Ù…","Ùˆ","Ø¬","Ùˆ","Ø¯","Ø¨"], words:["Ù…ÙˆØ¬ÙˆØ¯"]},
  {letters:["Øº","Ø±","ÛŒ","Ø¨","Ù‡","Ø§"], words:["ØºØ±Ø¨"]},
  {letters:["Ù","Ø§","Ø²","Ù„","Ùˆ","Ù†"], words:["ÙØ¶Ù„"]},
  {letters:["Ù†","Ùˆ","Ø±","Ù†","Ú˜","Ø§"], words:["Ù†ÙˆØ±"]},
  {letters:["Ø¯","Ø±","ÛŒ","Ù†","Ø§","Ùˆ"], words:["Ø¯Ø±ÛŒÙ†Ø§"]},
  {letters:["Ú©","Ùˆ","Ø±","Ø´","Ø¯","Ùˆ"], words:["Ú©ÙˆØ±Ø´"]},
  {letters:["Ø³","Ø§","Ø¯","Ù‡","Ù…","Ùˆ"], words:["Ø³Ø§Ø¯Ù‡"]},
  {letters:["Ø±","Ø§","Ù…","ÛŒ","Ù†","Ùˆ"], words:["Ø±Ø§Ù…ÛŒÙ†"]},
  {letters:["Ø´","Ø§","Ø°","Ø±","Ùˆ","Ù†"], words:["Ø´Ø§Ø°Ø±"]},
  {letters:["Ù†","Ùˆ","Ø±","Ùˆ","Ø²","Ø§"], words:["Ù†ÙˆØ±ÙˆØ²"]},
  {letters:["Ù","Ø±","Ùˆ","Øº","Ù†","Ø§"], words:["ÙØ±Ù‡Ù†Ú¯"]},
  {letters:["Ù…","Ø§","Ù‡","Ø±","Ø¨","Ùˆ"], words:["Ù…Ø§Ù‡"]},
  {letters:["Ø¨","Ùˆ","Ù","ÛŒ","Ù„","Ø§"], words:["Ø¨ÙˆÛŒ"]},
  {letters:["Ù","Ø±","Ø´","Øª","Øº","Ø§"], words:["ÙØ±Ø­"]},
  {letters:["Ù…","Ù†","Ùˆ","Ú†","Ù‡","Ø§"], words:["Ù…Ù†Ùˆ"]},
  {letters:["Øª","Ù‡","Ø±","Ø§","Ù†","Ùˆ"], words:["ØªÙ‡Ø±Ø§Ù†"]},
  {letters:["Ø§","Ø±","Ø¨","Ø§","Ø¨","Ùˆ"], words:["Ø¹Ø±Ø¨"]},
  {letters:["Ø¯","Ùˆ","Ø³","Øª","Ù†","Ø§"], words:["Ø¯ÙˆØ³Øª"]},
  {letters:["Ø³","ÛŒ","Ù…","Ø§","Ù†","Ùˆ"], words:["Ø³ÛŒÙ…Ø§"]},
  {letters:["Ú©","ÛŒ","Ù‡","Ø§","Ù†","Ùˆ"], words:["Ú©ÛŒÙ‡Ø§Ù†"]},
  {letters:["Ù†","Ùˆ","Ø±","Ø¯","ÛŒ","Ø§"], words:["Ù†ÙˆØ±"]},
  {letters:["Ù¾","Ø±","Ùˆ","Ø§","Ù†","Ùˆ"], words:["Ù¾Ø±ÙˆØ§Ù†"]},
  {letters:["Ø±","Ùˆ","Ø²","Ø¨","Ù‡","Ø§"], words:["Ø±ÙˆØ²"]},
  {letters:["Ø´","Ø§","Ù…","Ù„","Ù‡","Ùˆ"], words:["Ø´Ø§Ù…Ù„"]},
  {letters:["Ø¯","Ø±","Ùˆ","Øº","Ø´","Ø§"], words:["Ø¯Ø±Ø´Øª"]},
  {letters:["Ø¨","Ø±","Ù†","Ø§","Ù…","Ùˆ"], words:["Ø¨Ø±Ù†Ø§Ù…Ù‡"]},
  {letters:["Ø³","Ùˆ","Øª","Ø§","Ø±","Ù‡","Ù†"], words:["Ø³ØªØ§Ø±Ù‡"]},
  {letters:["Ù…","Ù‡","Ø±","ÛŒ","Ù†","Ø§"], words:["Ù…Ù‡Ø±ÛŒÙ†"]},
  {letters:["Ø´","Ù‡","Ø±","Ø¨","Ø§","Ù†","ÛŒ"], words:["Ø´Ù‡Ø±ÛŒØ§Ø±"]},
  {letters:["Ø³","Ù„","Ø·","Ù†","Ø§","Ø¨"], words:["Ø³Ù„Ø·Ø§Ù†"]},
  {letters:["Ø¨","Ù‡","Ø±","Ø§","Ù…","Ù†","Ùˆ"], words:["Ø¨Ù‡Ø±Ø§Ù…"]},
  {letters:["Ø¬","Ùˆ","Ø§","Ø¯","Ù†","Ø§"], words:["Ø¬ÙˆØ§Ø¯"]},
  {letters:["Ø±","Ø²","ÛŒ","Ù†","Ø§","Ùˆ"], words:["Ø±Ø²ÛŒÙ†"]},
  {letters:["Ø³","Ùˆ","Ø¯","Ø§","Ù†","Ùˆ"], words:["Ø³ÙˆØ§Ù†"]},
  {letters:["Ù…","Ù‡","Ø¯","ÛŒ","Ø³","Ø§"], words:["Ù…Ù‡Ø¯ÛŒ"]},
  {letters:["Ù†","Ùˆ","Ø´","Ø¯","Ø±","Ø§"], words:["Ù†ÙˆØ´"]},
  {letters:["Ø§","Ø±","Ù…","Øº","Ù†","Ø§"], words:["Ø§Ø±Ù…ØºØ§Ù†"]},
  {letters:["Ø¯","Ø±","ÛŒ","Ø§","Ù","Ù†"], words:["Ø¯Ø±ÛŒØ§"]},
  {letters:["Ø¨","Ù‡","Ù†","Ø±","Ùˆ","Ø§"], words:["Ø¨Ù‡Ù†Ø±"]},
  {letters:["Ø´","Ø§","Ù‡","Ø¯","Ø±","Ùˆ"], words:["Ø´Ø§Ù‡Ø¯"]},
  {letters:["Ø³","Ù…","ÛŒ","Ø±","Ø§","Ù†"], words:["Ø³Ù…ÛŒØ±Ø§"]},
  {letters:["Ù†","Ùˆ","Ø±","Ø¯","ÛŒ","Ø³"], words:["Ù†ÙˆØ±ÛŒØ³"]}
];

// Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ ØªÙ… Ù‡Ø± 10 Ù…Ø±Ø­Ù„Ù‡
const themes = [
  {bg: "linear-gradient(135deg, #b8860b, #ffd700)", color: "#ffd700", text: "#222", letterBg: "#222"},
  {bg: "linear-gradient(135deg, #118AB2, #06D6A0)", color: "#06D6A0", text: "#fff", letterBg: "#055a4a"},
  {bg: "linear-gradient(135deg, #EF476F, #FFD166)", color: "#FFD166", text: "#fff", letterBg: "#7d253a"},
  {bg: "linear-gradient(135deg, #8B0000, #FFA500)", color: "#FFA500", text: "#fff", letterBg: "#4a0000"},
  {bg: "linear-gradient(135deg, #4A4A8A, #9D4EDD)", color: "#9D4EDD", text: "#fff", letterBg: "#2a2a5a"},
  {bg: "linear-gradient(135deg, #003B46, #07575B)", color: "#66A5AD", text: "#fff", letterBg: "#00252e"},
  {bg: "linear-gradient(135deg, #E63946, #F1FAEE)", color: "#A8DADC", text: "#1D3557", letterBg: "#1D3557"},
  {bg: "linear-gradient(135deg, #5E548E, #E0B1CB)", color: "#D90429", text: "#F1E0D6", letterBg: "#3F2E5E"},
  {bg: "linear-gradient(135deg, #2B2D42, #8D99AE)", color: "#EDF2F4", text: "#2B2D42", letterBg: "#1A1C28"},
  {bg: "linear-gradient(135deg, #F28482, #91C36C)", color: "#F6F5AE", text: "#2B2D42", letterBg: "#5E2C2C"},
  {bg: "linear-gradient(135deg, #2A0944, #3FA796)", color: "#FEC260", text: "#FEC260", letterBg: "#1A052A"},
  {bg: "linear-gradient(135deg, #F4D35E, #C1292E)", color: "#2A2D43", text: "#F4D35E", letterBg: "#7A1E1E"},
  {bg: "linear-gradient(135deg, #3D5A80, #98C1D9)", color: "#E0FBFC", text: "#293241", letterBg: "#1E2B3A"},
  {bg: "linear-gradient(135deg, #FF512F, #F09819)", color: "#FFFFFF", text: "#FF512F", letterBg: "#9F321F"},
  {bg: "linear-gradient(135deg, #3A1C71, #D76D77)", color: "#FFAF7B", text: "#3A1C71", letterBg: "#251247"}
];

let stageIndex = parseInt(localStorage.getItem("dj_stage")) || 0;
let coins = parseInt(localStorage.getItem("dj_coins")) || 0;
let selected = [], last = null, isDown = false;
const savedName = localStorage.getItem("dj_player");

const entry = document.getElementById("entry-screen");
const login = document.getElementById("login-screen");
const game = document.getElementById("game-screen");
const player = document.getElementById("player");
const coinCount = document.getElementById("coin-count");
const title = document.getElementById("stage-title");
const boxes = document.getElementById("word-boxes");
const container = document.getElementById("letters-container");
const lines = document.getElementById("lines");
const word = document.getElementById("selected-word");
const panel = document.getElementById("hint-panel");
const thanks = document.getElementById("thank-you");

function show(screen) {
  entry.style.display = "none";
  login.style.display = "none";
  game.style.display = "none";
  if (screen === "entry") entry.style.display = "block";
  if (screen === "login") login.style.display = "flex";
  if (screen === "game") game.style.display = "flex";
}

function applyTheme() {
  const themeGroup = Math.floor(stageIndex / 10) % themes.length;
  const theme = themes[themeGroup];
  game.style.background = theme.bg;
  title.style.color = theme.color;
  title.style.textShadow = "0 2px 4px rgba(0,0,0,0.3)";
  word.style.color = theme.color;
  word.style.textShadow = "0 1px 2px rgba(0,0,0,0.3)";
  
  const letters = container.querySelectorAll('.letter');
  letters.forEach(l => {
    l.style.background = theme.letterBg;
    l.style.color = theme.color;
    l.style.border = `3px solid ${theme.color}`;
  });
  
  const charBoxes = document.querySelectorAll('.char-box');
  charBoxes.forEach(b => {
    b.style.color = theme.color;
    b.style.border = `2px solid ${theme.color}`;
  });
  
  const filled = document.querySelectorAll('.filled');
  filled.forEach(f => {
    f.style.background = theme.color;
    f.style.color = theme.text;
  });
}

document.getElementById('start-main').onclick = () => {
  if (savedName) {
    show("game");
    coinCount.textContent = coins;
    loadStage();
  } else {
    show("login");
  }
};

document.getElementById('back-to-entry').onclick = () => show("entry");
document.getElementById('start-game').onclick = () => {
  if (!player.value.trim()) { alert("Ø§Ø³Ù…ØªÙˆ ÙˆØ§Ø±Ø¯ Ú©Ù†!"); return; }
  localStorage.setItem("dj_player", player.value.trim());
  show("game");
  coinCount.textContent = coins;
  loadStage();
};

document.getElementById('logout-btn').onclick = () => {
  if (confirm("Ø­Ø³Ø§Ø¨ Ù¾Ø§Ú© Ø¨Ø´Ù‡ØŸ")) {
    localStorage.clear();
    location.reload();
  }
};

document.getElementById('dai-help').onclick = () => {
  panel.style.display = panel.style.display === "flex" ? "none" : "flex";
};

document.getElementById('hint-letter').onclick = () => {
  if (coins < 5) { alert("Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª!"); return; }
  const w = stages[stageIndex].words[0];
  const empty = [...boxes.children[0].children].find(b => !b.textContent);
  if (empty) {
    const i = [...boxes.children[0].children].indexOf(empty);
    empty.textContent = w[i];
    empty.classList.add("filled");
    empty.style.background = "#ffd700";
    empty.style.color = "#222";
    coins -= 5;
    coinCount.textContent = coins;
    localStorage.setItem("dj_coins", coins);
  }
  panel.style.display = "none";
};

document.getElementById('hint-skip').onclick = () => {
  if (coins < 15) { alert("Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª!"); return; }
  coins -= 15;
  stageIndex++;
  localStorage.setItem("dj_coins", coins);
  localStorage.setItem("dj_stage", stageIndex);
  panel.style.display = "none";
  loadStage();
};

function showThanks() {
  const msgs = ["Ú¯Ù„ Ú©Ø§Ø´ØªÛŒ! ğŸŒ¸", "Ù…Ù…Ù†ÙˆÙ†Ù… Ø¹Ø²ÛŒØ²Ù…! ğŸ™", "Ø®ÛŒÙ„ÛŒ Ù…Ù…Ù†ÙˆÙ†! ğŸ’›"];
  thanks.textContent = msgs[Math.floor(Math.random() * msgs.length)];
  thanks.style.display = "flex";
  setTimeout(() => thanks.style.display = "none", 1500);
}

function loadStage() {
  if (stageIndex >= stages.length) {
    alert("ØªØ¨Ø±ÛŒÚ©! ğŸŒŸ Ù‡Ù…Ù‡ Û±ÛµÛ° Ù…Ø±Ø­Ù„Ù‡ ØªÙ…ÙˆÙ… Ø´Ø¯!");
    return;
  }
  const st = stages[stageIndex];
  container.innerHTML = ""; lines.innerHTML = "";
  selected = []; last = null;
  title.textContent = "Ù…Ø±Ø­Ù„Ù‡ " + (stageIndex + 1);
  boxes.innerHTML = ""; word.textContent = "...";

  st.words.forEach(w => {
    const row = document.createElement("div");
    row.className = "word-box"; row.dataset.word = w;
    for (let c of w) {
      const box = document.createElement("div");
      box.className = "char-box";
      row.appendChild(box);
    }
    boxes.appendChild(row);
  });

  const r = 110, cx = 130, cy = 130;
  const ang = 2 * Math.PI / st.letters.length;
  st.letters.forEach((ltr, i) => {
    const div = document.createElement("div");
    div.className = "letter"; div.textContent = ltr;
    const a = i * ang - Math.PI / 2;
    div.style.left = (cx + r * Math.cos(a) - 28) + "px";
    div.style.top = (cy + r * Math.sin(a) - 28) + "px";
    container.appendChild(div);
  });

  applyTheme();
}

function center(el) {
  const r = el.getBoundingClientRect();
  return {x: r.left + r.width/2, y: r.top + r.height/2};
}

function pick(el) {
  if (selected.includes(el)) return;
  el.classList.add("selected");
  selected.push(el);
  if (last) {
    const p1 = center(last), p2 = center(el);
    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", p1.x); line.setAttribute("y1", p1.y);
    line.setAttribute("x2", p1.x); line.setAttribute("y2", p1.y);
    line.setAttribute("stroke", "#ffd700"); line.setAttribute("stroke-width", "2");
    lines.appendChild(line);
    requestAnimationFrame(() => {
      line.setAttribute("x2", p2.x); line.setAttribute("y2", p2.y);
    });
  }
  last = el;
  word.textContent = selected.map(e => e.textContent).join("");
}

container.addEventListener("pointerdown", e => {
  if (e.target.classList.contains("letter")) { isDown = true; pick(e.target); }
});
container.addEventListener("pointermove", e => {
  if (!isDown) return;
  const el = document.elementFromPoint(e.clientX, e.clientY);
  if (el && el.classList.contains("letter")) pick(el);
});
container.addEventListener("pointerup", () => isDown = false);
container.addEventListener("pointerleave", () => isDown = false);

document.getElementById('check-btn').onclick = () => {
  const stage = stages[stageIndex];
  let matched = null;
  for (let w of stage.words) {
    if (w.length !== selected.length) continue;
    let ok = true;
    for (let i = 0; i < w.length; i++) {
      if (w[i] !== selected[i].textContent) { ok = false; break; }
    }
    if (ok) { matched = w; break; }
  }

  if (matched) {
    const row = [...boxes.children].find(r => r.dataset.word === matched);
    [...row.children].forEach((c, i) => {
      c.textContent = matched[i];
      c.classList.add("filled");
      c.style.background = "#ffd700";
      c.style.color = "#222";
    });
    const done = [...boxes.children].filter(r => [...r.children].every(c => c.classList.contains("filled"))).length;
    if (done === stage.words.length) {
      showThanks();
      coins += 10;
      stageIndex++;
      localStorage.setItem("dj_coins", coins);
      localStorage.setItem("dj_stage", stageIndex);
      setTimeout(() => {
        if (stageIndex < stages.length) loadStage();
        else alert("ØªØ¨Ø±ÛŒÚ©! ğŸŒŸ Ù‡Ù…Ù‡ Û±ÛµÛ° Ù…Ø±Ø­Ù„Ù‡ ØªÙ…ÙˆÙ… Ø´Ø¯!");
      }, 1600);
    }
  }

  selected.forEach(a => {
    a.classList.remove("selected");
    a.style.background = "#222";
    a.style.color = "#ffd700";
  });
  selected = []; last = null; lines.innerHTML = "";
  word.textContent = "...";
};

coinCount.textContent = coins;
if (savedName && stageIndex < stages.length) {
  show("game");
  loadStage();
} else {
  show("entry");
}

document.addEventListener("click", (e) => {
  if (!panel.contains(e.target) && e.target.id !== "dai-help") {
    panel.style.display = "none";
  }
});

// Ø§ÛŒÙ…ÛŒÙ„ Ùˆ Ø¯Ø¹ÙˆØª
document.getElementById('item-suggestions').onclick = () => {
  alert('Ù„Ø·ÙØ§Ù‹ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø§ÛŒÙ† Ø§ÛŒÙ…ÛŒÙ„ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯:\n\ndaijavad.game@gmail.com');
};

document.getElementById('item-invite').onclick = () => {
  const url = window.location.href;
  if (navigator.share) {
    navigator.share({ title: 'Ø¯Ø§ÛŒÛŒ Ø¬ÙˆØ§Ø¯', text: 'Ø¨ÛŒØ§ Ø¨Ø§ Ù‡Ù… Ø¨Ø§Ø²ÛŒ Ú©Ù†ÛŒÙ…! ğŸŒŸ', url });
  } else {
    navigator.clipboard.writeText(url).then(() => {
      alert('Ù„ÛŒÙ†Ú© Ø¨Ø§Ø²ÛŒ Ú©Ù¾ÛŒ Ø´Ø¯! Ø¨Ø±Ø§Ø´ Ø¨ÙØ±Ø³Øª.');
    }).catch(() => {
      alert('Ù„ÛŒÙ†Ú©: ' + url);
    });
  }
};
</script>

</body>
</html>